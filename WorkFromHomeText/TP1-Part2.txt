
Humans and animals are able to make decisions when they faced a binary alternative. In this section, we will model decision making using sequential probability ratio test (SPRT). This model can be used in a random dot motion task (see [here](https://www.youtube.com/watch?v=oDxcyTn-0os) for an example). In this paradigm, a patch of points moving either on average to the left or to the right is shown to the subject that has to determine the direction of movement. Subjects' goal is to determine the direction of the dots which can be easy or though depending on the coherence of each individual point.


In this tutorial, we consider a simplified version of the random dot motion task. On each trial $i$, the subject is shown a single dot moving at velocity $v_i$ generated by a fixed probability distribution, which we know to be either: 


$$
\\
\begin{eqnarray}
p_L &=& \mathcal{N}\left(-1,\sigma^2\right)\\
&& \textrm{or}\\
p_R &=& \mathcal{N}\left(+1,\sigma^2\right)\\
\end{eqnarray}
$$

This means that the dot is moving leftward or rightward and that its speed is normally distributed around $|1|$. We want to determine which distribution amongst $p_L$ and $p_R$ is the true data generating distribution. In order to do that, we will define two alternative hypotheses, the first one $H_L$ states that $p_L$ is the data generating distribution while $H_R$ states that it is $p_R$. The decision process is based on the time-evolution of the log likelihood ratio between these two hypotheses. For both hypothesis, we will define the likelihood function that will quantify how probable it is that the data point $x_i$ comes from a given distribution. For a given occurence of the point $x_i$, the two likelihood functions will be defined by $p_L\left(x_i|z=0\right)$ and $p_R\left(x_i|z=1\right)$, which are two gaussian distributions.


Using the following gaussian observations models

$$\begin{eqnarray}
p_L\left(x|z=0\right) & = & \mathcal{N}\left(\mu_L,\sigma_L^2\right)\\
p_R\left(x|z=1\right) & = & \mathcal{N}\left(\mu_R,\sigma_R^2\right)\\
\end{eqnarray}
$$

and the definition of the log-likelihood ratio

**Compute the expression of $\log \Lambda_i$, the log-likelihood ratio at iteration $i$** 

Click [here](https://github.com/fblondiaux/LGBIO2060-2020/blob/Hakuri/Solutions/Tuto1SolLikelihood) for solution


Without loss of generality, let's further assume the true data generating distribution is $p_R$. In this case $x_i$ can be expressed as $x_i = \mu_R + \sigma_R \epsilon$ where $\epsilon$ comes from a standard Gaussian. The foregoing formula can then be rewritten as
$$
\log \Lambda_i = \left( \log\dfrac{\sigma_L}{\sigma_R} + 0.5\dfrac{\left(\mu_R-\mu_L\right)^2}{\sigma_L^2}\right) + \left(\dfrac{\mu_L-\mu_R}{\sigma_L^2}\sigma_R\,\epsilon - 0.5\left[1-\left(\dfrac{\sigma_R}{\sigma_L}\right)^2\right]\epsilon^2\right)
$$

Where the first two constant terms serve as the drifting part and the last terms are the diffusion part. If we further let $\sigma_L = \sigma_R$, we can get rid of the quadratic term and this reduces to the classical deiscrete drift-diffusion equation where we have analytical solutions for mean and expected auto-covariance:

$$
\log \Lambda_i = 0.5\dfrac{\left(\mu_R - \mu_L\right)^2}{\sigma_L^2} + \dfrac{\mu_R - \mu_L}{\sigma_L^2}\epsilon, \,\,\,\,\, \text{where } \epsilon\sim\mathcal{N}\left(0,1\right)
$$

Using this very last expression, implement the function *compute_SPRT* whose signature is given below.